---
openapi: 3.0.1
info:
  title: Audit Manager Service
  description: Rest Endpoints for operations related to audit
  license:
    name: Mosip
    url: https://docs.mosip.io/platform/license
  version: '1.0'
servers:
- url: https://api-internal.collab.mosip.net/v1/auditmanager
  description: For Swagger
tags:
- name: Audit manager controller
  description: Rest endpoints which consist of operations related to Audit Management
paths:
  "/audits":
    post:
      tags:
      - Audit manager controller
      summary: Persist a audit
      description: persist a audit
      operationId: addAudit
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/RequestWrapperAuditRequestDto"
            examples:
              AuditExmaple:
                summary: Example audit request
                value: 
                   id: "REQ-001"
                   version: "1.0"
                   requesttime: "2025-07-06T10:45:00Z"
                   metadata: {}
                   request:
                    eventId: "EVT-20230704-001"
                    eventName: "UserLogin"
                    eventType: "Authentication"
                    actionTimeStamp: "2025-07-06T10:45:00Z"
                    hostName: "auth-server-1"
                    hostIp: "192.168.1.100"
                    applicationId: "APP-001"
                    applicationName: "IdentityManagement"
                    sessionUserId: "USR-001"
                    sessionUserName: "johndoe"
                    id: "ENTITY-001"
                    idType: "USER_ID"
                    createdBy: "system"
                    moduleName: "LoginModule"
                    
                    
        required: true
      responses:
        '200':
          description: Success or you may find errors in error array in response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ResponseWrapperAuditResponseDto"
              examples:
                AuditSuccessResponse:
                  summary: Succesful audit record creation
                  value:
                    id: "RESP-001"
                    version: "1.0"
                    responsetime: "2025-07-06T10:45:30Z"
                    metadata: {}
                    response:
                      status: true
                    errors: []
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
components:
  schemas:
    AuditRequestDto:
      required:
      - actionTimeStamp
      - applicationId
      - applicationName
      - createdBy
      - eventId
      - eventName
      - eventType
      - hostIp
      - hostName
      - sessionUserId
      type: object
      properties:
        eventId:
          description: Unique indentifier for event
          maxLength: 64
          minLength: 1
          type: string
          
        eventName:
          description : Name of the event
          maxLength: 128
          minLength: 1
          type: string
          
        eventType:
          description: Type of the event 
          maxLength: 64
          minLength: 1
          type: string
          
        actionTimeStamp:
          description: Timestamp when the event occurred (in ISO date-time format)
          type: string
          format: date-time
          
        hostName:
          description: Name of the host machine
          maxLength: 128
          minLength: 1
          type: string
          
        hostIp:
          description: IP address of the host machine
          maxLength: 256
          minLength: 1
          type: string
          
        applicationId:
          description: Unique identifier of the application generating the audit event
          maxLength: 64
          minLength: 1
          type: string
          
        applicationName:
          description: Name of the application
          maxLength: 128
          minLength: 1
          type: string
          
        sessionUserId:
          description: Unique identifier of the user who initiated the session
          maxLength: 256
          minLength: 1
          type: string
          
        sessionUserName:
          description: Name of the user who initiated the session
          maxLength: 128
          minLength: 1
          type: string
          
        id:
          maxLength: 64
          minLength: 0
          type: string
          description: Identifier for the entity involved in the event
          
        idType:
          maxLength: 64
          minLength: 0
          type: string
          description: Type of id
          
        createdBy:
          description: Name or identifier of the user or service that created this audit record
          maxLength: 256
          minLength: 1
          type: string
          
        moduleName:
          description: Name of the application module
          maxLength: 128
          minLength: 0
          type: string
          
        moduleId:
          description: Unique identifier of the module
          maxLength: 64
          minLength: 0
          type: string
          
        description:
          description: Detailed description or remarks about the event
          maxLength: 2048
          minLength: 0
          type: string
          
    RequestWrapperAuditRequestDto:
      required:
      - request
      type: object
      properties:
        id:
          description: Unique identifier for the request message
          type: string
          
        version:
          description: Version number of the API contract or message format
          type: string
          
        requesttime:
          description: Date and time when the request was sent 
          type: string
          format: date-time
          
        metadata:
          description: Optional metadata associated with the request
          type: object
          
        request:
          "$ref": "#/components/schemas/AuditRequestDto"
          
    AuditResponseDto:
      type: object
      properties:
        status:
          description: Indicates whether the audit operation was successful (true) or failed (false)
          type: boolean
          
    ResponseWrapperAuditResponseDto:
      required:
      - response
      type: object
      properties:
        id:
          description: Unique identifier for the response message
          type: string
          
        version:
          description: Version number of the API contract or message format
          type: string
          
        responsetime:
          description: Date and time when the response was sent 
          type: string
          format: date-time
          
        metadata:
          description: Optional metadata associated with the response
          type: object
          
        response:
          "$ref": "#/components/schemas/AuditResponseDto"
          
          
        errors:
          description: List of errors encountered during processing(if any)
          type: array
          items:
            "$ref": "#/components/schemas/ServiceError"
            
    ServiceError:
      type: object
      properties:
        errorCode:
          description: Application-defined error code representing the specific error condition
          type: string
          
        message:
          description: Human-readable message describing the error
          type: string

